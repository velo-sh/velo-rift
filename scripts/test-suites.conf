# Test Suite Configuration (SSOT)

# Python Test Paths
TEST_PATHS_QUICK="tests/qa/quick"
TEST_PATHS_FULL="tests/poc"
TEST_PATHS_DOCKER="tests/poc"

# Tier 0: Fast checks (Build + Crate Tests + Static Analysis)
TIER0_TESTS=(
    "cargo fmt --check"
    "cargo clippy --workspace -- -D warnings"
    "run_rust_tests"
)

# Tier 1: Functional Integration (Core E2E)
TIER1_TESTS=(
    "./scripts/v-integration.sh"
    "./scripts/test_shim_basic.sh"
    "./scripts/test_cow.sh"
    "./scripts/test_gc.sh"
    # "./tests/poc/test_shim_init_hang.sh" # FIXME: Hangs on macOS
    "./tests/poc/test_bug007_bootstrap.sh"
    "python3 scripts/gc_e2e_test.py"
)

# Tier 2: Extended E2E (Demos + Issue Regressions)
TIER2_TESTS=(
    "./scripts/demo_phantom.sh"
    "./scripts/demo_gc.sh"

    "python3 scripts/e2e_test.py"
    # Issue Regression Tests
    "./tests/poc/test_issue1_recursion_deadlock.sh"
    "./tests/poc/test_issue2_tls_bootstrap_hang.sh"
    "./tests/poc/test_issue3_single_file_ingest.sh"
    # New Concurrent Tests
    "./tests/poc/test_concurrent_stress.sh"
    "./tests/poc/test_concurrent_write.sh"
    # New Pull Integration
    "./tests/poc/repro_shim_init_race.sh"
    "./tests/poc/test_shell_chmod_interception.sh"
    "./tests/poc/test_shell_mutation_suite.sh"
    "./tests/poc/test_at_syscall_family.sh"
    # Phase 2 QA Suite
    "./tests/qa_v2/test_v2_daemon_autostart.sh"
    "./tests/qa_v2/test_v2_persistence.sh"
    "./tests/qa_v2/test_v2_service_control.sh"
    "./tests/qa_v2/test_e2e_golden_path.sh"
    "./tests/qa_v2/test_value_1_dedup.sh"
    "./tests/qa_v2/test_value_2_rename.sh"
    # Flaky/Stress tests moved from Tier 1
    "./scripts/test_abi_hazard.sh"
    "./tests/qa_v2/repro_cli_broken_pipe.sh"
    "./tests/qa_v2/repro_rwlock_stress.sh"
    "./tests/qa_v2/repro_shim_rwlock_hang.sh"
)

# Tier 3: Performance & Scale (Benchmarks)
TIER3_TESTS=(
    "python3 scripts/benchmark_suite.py --all"
    "./scripts/benchmark_node_modules.sh"
    "./scripts/benchmark_parallel.sh --size small"
)

# Tier 4: Comprehensive POC Suite (Gap Analysis + Security)
# NOTE: Gap tests report missing syscall implementations - expected failures
# These run in report mode (non-blocking) to generate coverage reports
TIER4_MODE="report"  # "strict" or "report"
TIER4_TESTS=(
    # Gap Tests (Quick static checks - some may fail = gap detected)
    "./tests/poc/test_gap_copy_file_range.sh"
    "./tests/poc/test_gap_ctime.sh"
    "./tests/poc/test_gap_dup_tracking.sh"
    "./tests/poc/test_gap_fchdir.sh"
    "./tests/poc/test_gap_fcntl_lock.sh"
    "./tests/poc/test_gap_flock_semantic.sh"
    "./tests/poc/test_gap_ftruncate.sh"
    "./tests/poc/test_gap_inode_uniqueness.sh"
    "./tests/poc/test_gap_lseek.sh"
    "./tests/poc/test_gap_mmap_shared.sh"
    "./tests/poc/test_gap_readdir_order.sh"
    "./tests/poc/test_gap_sendfile.sh"
    "./tests/poc/test_gap_st_dev.sh"
    "./tests/poc/test_gap_st_nlink.sh"
    "./tests/poc/test_gap_symlink.sh"
    "./tests/poc/test_gap_utimes.sh"
    "./tests/poc/test_gap_xattr.sh"
    # Security Verification
    "./tests/poc/verify_privilege_escalation.sh"
    # RFC-0047 Gap Analysis
    "./tests/poc/test_rfc0047_cow_write_close.sh"
    "./tests/poc/test_rfc0047_unlink_vfs.sh"
    "./tests/poc/verify_iron_law.sh"
    "./scripts/demo_dedup.sh"
    # RFC-0047 Extended Tests
    "./tests/poc/test_rfc0047_mkdir_vfs.sh"
    "./tests/poc/test_rfc0047_rename_vfs.sh"
    "./tests/poc/test_rfc0047_rmdir_vfs.sh"
    "./tests/poc/test_rfc0047_open_mode_check.sh"
    # New VFS Parameter & Bypass Tests
    "./tests/poc/test_gap_fchmod_bypass.sh"
    "./tests/poc/test_gap_mkdirat_bypass.sh"
    "./tests/poc/test_gap_unlinkat_bypass.sh"
    "./tests/poc/test_gap_renameat_bypass.sh"
    "./tests/poc/test_access_permission.sh"
    "./tests/poc/test_statx_interception.sh"
    "./tests/poc/test_read_syscall.sh"
)

